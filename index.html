<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>Paddle Quest - Controls with Pause & Home</title>
<style>
  body {
    margin: 0; 
    overflow: hidden;
    background: #222;
    color: white;
    font-family: Arial, sans-serif;
    user-select: none;
    -webkit-user-select: none;
    -webkit-touch-callout: none;
  }
  #game {
    position: relative;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    background: #111;
  }
  #paddle {
    position: absolute;
    bottom: 100px; /* space for controls */
    left: 50%;
    transform: translateX(-50%);
    width: 120px;
    height: 20px;
    background: #0af;
    border-radius: 10px;
  }
  #ball {
    position: absolute;
    width: 20px;
    height: 20px;
    background: #fa0;
    border-radius: 50%;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
  }
  /* Controls container fixed at bottom center */
  #controls {
    position: fixed;
    bottom: env(safe-area-inset-bottom, 20px);
    left: 50%;
    transform: translateX(-50%);
    width: 180px;
    height: 80px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    z-index: 1000;
    pointer-events: auto;
  }
  .arrow {
    width: 70px;
    height: 70px;
    user-select: none;
    -webkit-user-drag: none;
    touch-action: none;
  }
  /* Pause and Home buttons top corners */
  #pauseBtn, #homeBtn {
    position: fixed;
    top: env(safe-area-inset-top, 20px);
    width: 50px;
    height: 50px;
    user-select: none;
    -webkit-user-drag: none;
    touch-action: none;
    cursor: pointer;
    z-index: 1100;
  }
  #pauseBtn {
    left: env(safe-area-inset-left, 20px);
  }
  #homeBtn {
    right: env(safe-area-inset-right, 20px);
  }

  /* Pause overlay */
  #pauseOverlay {
    display: none;
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.7);
    color: white;
    font-size: 3em;
    font-weight: bold;
    text-align: center;
    line-height: 100vh;
    z-index: 1200;
    user-select: none;
  }
</style>
</head>
<body>
<div id="game">
  <div id="paddle"></div>
  <div id="ball"></div>
</div>

<!-- Controls -->
<div id="controls">
  <img id="leftArrow" src="left.png" alt="Left Arrow" class="arrow" />
  <img id="rightArrow" src="right.png" alt="Right Arrow" class="arrow" />
</div>

<!-- Pause and Home -->
<img id="pauseBtn" src="pause.png" alt="Pause" />
<img id="homeBtn" src="home.png" alt="Home" />

<!-- Pause Overlay -->
<div id="pauseOverlay">Paused</div>

<script>
  const paddle = document.getElementById('paddle');
  const ball = document.getElementById('ball');
  const leftArrow = document.getElementById('leftArrow');
  const rightArrow = document.getElementById('rightArrow');
  const pauseBtn = document.getElementById('pauseBtn');
  const homeBtn = document.getElementById('homeBtn');
  const pauseOverlay = document.getElementById('pauseOverlay');

  const paddleSpeed = 5; // px per frame
  let movingLeft = false;
  let movingRight = false;
  let paused = false;

  // Prevent context menu on all control images
  [leftArrow, rightArrow, pauseBtn, homeBtn].forEach(el => {
    el.addEventListener('contextmenu', e => e.preventDefault());
    el.addEventListener('touchstart', e => e.preventDefault());
    el.addEventListener('touchmove', e => e.preventDefault());
  });

  // Arrow controls pointer events
  leftArrow.addEventListener('pointerdown', () => { if(!paused) movingLeft = true; });
  rightArrow.addEventListener('pointerdown', () => { if(!paused) movingRight = true; });

  ['pointerup', 'pointerleave', 'pointercancel'].forEach(evt => {
    leftArrow.addEventListener(evt, () => { movingLeft = false; });
    rightArrow.addEventListener(evt, () => { movingRight = false; });
  });

  // Pause button toggle
  pauseBtn.addEventListener('click', () => {
    paused = !paused;
    pauseOverlay.style.display = paused ? 'block' : 'none';
  });

  // Home button reloads page (simulate main menu)
  homeBtn.addEventListener('click', () => {
    location.reload();
  });

  // Paddle movement boundaries
  function clamp(value, min, max) {
    return Math.min(Math.max(value, min), max);
  }

  // Initialize paddle position
  function init() {
    const gameWidth = document.getElementById('game').clientWidth;
    paddle.style.left = (gameWidth / 2 - paddle.offsetWidth / 2) + 'px';
  }

  // Example ball movement (basic bouncing)
  let ballSpeedX = 3;
  let ballSpeedY = 3;

  function gameLoop() {
    if (!paused) {
      let gameRect = document.getElementById('game').getBoundingClientRect();
      let paddleLeft = paddle.offsetLeft;
      let paddleTop = paddle.offsetTop;

      // Move paddle
      let currentLeft = paddle.offsetLeft;
      if (movingLeft) {
        currentLeft = clamp(currentLeft - paddleSpeed, 0, gameRect.width - paddle.offsetWidth);
        paddle.style.left = currentLeft + 'px';
      }
      if (movingRight) {
        currentLeft = clamp(currentLeft + paddleSpeed, 0, gameRect.width - paddle.offsetWidth);
        paddle.style.left = currentLeft + 'px';
      }

      // Move ball
      let ballLeft = ball.offsetLeft;
      let ballTop = ball.offsetTop;
      ballLeft += ballSpeedX;
      ballTop += ballSpeedY;

      // Bounce off left/right walls
      if (ballLeft <= 0 || ballLeft + ball.offsetWidth >= gameRect.width) {
        ballSpeedX = -ballSpeedX;
      }
      // Bounce off top
      if (ballTop <= 0) {
        ballSpeedY = -ballSpeedY;
      }
      // Bounce off paddle
      if (
        ballTop + ball.offsetHeight >= paddleTop &&
        ballLeft + ball.offsetWidth >= paddleLeft &&
        ballLeft <= paddleLeft + paddle.offsetWidth
      ) {
        ballSpeedY = -ballSpeedY;
        ballTop = paddleTop - ball.offsetHeight; // reposition on top of paddle
      }
      // Bounce off bottom (reset to center)
      if (ballTop + ball.offsetHeight >= gameRect.height) {
        ballLeft = gameRect.width / 2 - ball.offsetWidth / 2;
        ballTop = gameRect.height / 2 - ball.offsetHeight / 2;
        ballSpeedY = -ballSpeedY;
      }

      ball.style.left = ballLeft + 'px';
      ball.style.top = ballTop + 'px';
    }

    requestAnimationFrame(gameLoop);
  }

  window.addEventListener('resize', init);
  window.addEventListener('load', () => {
    init();
    // Start ball in center
    const game = document.getElementById('game');
    ball.style.left = (game.clientWidth / 2 - ball.offsetWidth / 2) + 'px';
    ball.style.top = (game.clientHeight / 2 - ball.offsetHeight / 2) + 'px';

    gameLoop();
  });
</script>
</body>
</html>
