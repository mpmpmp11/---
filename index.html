<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Paddle Quest - Mobile Responsive with Visible Arrows</title>
  <link href="https://fonts.googleapis.com/css2?family=Lilita+One&display=swap" rel="stylesheet" />
  <style>
    * {
      box-sizing: border-box;
    }
    body, html {
      margin: 0; padding: 0;
      background: #111;
      color: white;
      font-family: Arial, sans-serif;
      height: 100vh;
      overflow: hidden;
    }
    #homeMenu, #gameArea {
      width: 100vw;
      height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      -webkit-tap-highlight-color: transparent;
      -webkit-user-select: none;
      user-select: none;
      -webkit-touch-callout: none;
      position: relative;
    }
    #homeMenu {
      background: #222;
    }
    #gameArea {
      display: none;
      position: relative;
      background: #000;
    }
    canvas {
      background: #111;
      display: block;
      border: 2px solid #0ff;
      border-radius: 10px;
    }
    .controls {
      position: absolute;
      bottom: 12vh;      /* moved up from bottom to avoid Android bottom bar */
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      justify-content: center;
      gap: 15px;
      touch-action: none;
      z-index: 15;
    }
    .controls img {
      width: 60px;
      height: 60px;
      user-select: none;
      cursor: pointer;
      transition: transform 0.15s ease, box-shadow 0.15s ease;
      -webkit-user-drag: none;
    }
    .controls img:active {
      transform: scale(0.9);
      box-shadow: 0 0 10px #0ff;
    }
    .topButtons {
      position: absolute;
      top: 10px;
      right: 10px;
      display: flex;
      gap: 12px;
      z-index: 10;
    }
    .topButtons img {
      width: 45px;
      height: 45px;
      cursor: pointer;
      user-select: none;
      transition: transform 0.15s ease, box-shadow 0.15s ease;
      -webkit-user-drag: none;
    }
    .topButtons img:active {
      transform: scale(0.9);
      box-shadow: 0 0 12px #0ff;
    }
    #pauseOverlay {
      position: absolute;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      background: rgba(0,0,0,0.75);
      color: #0ff;
      font-family: 'Lilita One', cursive;
      font-size: 7vw;
      display: flex;
      align-items: center;
      justify-content: center;
      user-select: none;
      z-index: 9;
      display: none;
      -webkit-user-select: none;
    }
    #scoreBoard {
      position: absolute;
      top: 12px;
      left: 12px;
      color: #0ff;
      font-family: 'Lilita One', cursive;
      font-size: 4vw;
      user-select: none;
      z-index: 11;
      text-shadow: 0 0 6px #0ff;
    }
    button {
      padding: 14px 30px;
      font-size: 24px;
      border: none;
      border-radius: 8px;
      background: #0ff;
      color: #000;
      cursor: pointer;
      transition: background-color 0.3s ease;
      user-select: none;
      -webkit-user-select: none;
    }
    button:hover {
      background: #0cc;
    }
  </style>
</head>
<body>

<!-- HOME MENU -->
<div id="homeMenu">
  <h1>Paddle Quest</h1>
  <button id="startBtn">Start Game</button>
</div>

<!-- GAME AREA -->
<div id="gameArea">
  <div class="topButtons">
    <img src="pause.png" alt="Pause" id="pauseBtn" title="Pause/Resume" />
    <img src="home.png" alt="Home" id="homeBtn" title="Home" />
  </div>

  <canvas id="gameCanvas"></canvas>
  <div id="scoreBoard">Score: 0 | High: 0</div>

  <div class="controls">
    <img src="left.png" alt="Left" id="leftBtn" title="Move Left" />
    <img src="right.png" alt="Right" id="rightBtn" title="Move Right" />
  </div>

  <div id="pauseOverlay">Game Paused</div>
</div>

<script>
  const homeMenu = document.getElementById("homeMenu");
  const gameArea = document.getElementById("gameArea");
  const startBtn = document.getElementById("startBtn");
  const pauseBtn = document.getElementById("pauseBtn");
  const homeBtn = document.getElementById("homeBtn");
  const leftBtn = document.getElementById("leftBtn");
  const rightBtn = document.getElementById("rightBtn");
  const pauseOverlay = document.getElementById("pauseOverlay");
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");
  const scoreBoard = document.getElementById("scoreBoard");

  // Set canvas size to fill viewport exactly (width & height)
  function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  resizeCanvas();
  window.addEventListener("resize", () => {
    resizeCanvas();
    initializeGameObjects();
  });

  // GAME STATE (scaled based on canvas size)
  let paddle = {
    widthRatio: 0.17,
    heightRatio: 0.045,
    speedRatio: 0.025,
    x: 0,
    y: 0,
    width: 0,
    height: 0,
    targetX: 0,
    speed: 0,
  };

  let ball = {
    radiusRatio: 0.03,
    x: 0,
    y: 0,
    radius: 0,
    dxRatio: 0.008,
    dyRatio: 0.008,
    dx: 0,
    dy: 0,
  };

  let rightPressed = false;
  let leftPressed = false;
  let gamePaused = false;
  let animationFrameId = null;

  let score = 0;
  let highScore = localStorage.getItem("paddleQuestHighScore") || 0;

  function initializeGameObjects() {
    paddle.width = canvas.width * paddle.widthRatio;
    paddle.height = canvas.height * paddle.heightRatio;
    paddle.speed = canvas.width * paddle.speedRatio;

    paddle.x = canvas.width / 2 - paddle.width / 2;
    paddle.y = canvas.height - paddle.height - canvas.height * 0.02;
    paddle.targetX = paddle.x;

    ball.radius = canvas.width * ball.radiusRatio;
    ball.x = canvas.width / 2;
    ball.y = canvas.height / 2;

    ball.dx = canvas.width * ball.dxRatio;
    ball.dy = -canvas.height * ball.dyRatio;

    score = 0;
    updateScoreDisplay();
  }

  function updateScoreDisplay() {
    scoreBoard.textContent = `Score: ${score} | High: ${highScore}`;
  }

  function lerp(start, end, t) {
    return start + (end - start) * t;
  }

  startBtn.addEventListener("click", () => {
    homeMenu.style.display = "none";
    gameArea.style.display = "flex";
    gamePaused = false;
    pauseOverlay.style.display = "none";
    initializeGameObjects();
    animate();
  });

  pauseBtn.addEventListener("click", () => {
    togglePause();
  });

  homeBtn.addEventListener("click", () => {
    cancelAnimationFrame(animationFrameId);
    gameArea.style.display = "none";
    homeMenu.style.display = "flex";
    gamePaused = false;
    pauseOverlay.style.display = "none";
  });

  leftBtn.addEventListener("touchstart", e => {
    e.preventDefault();
    leftPressed = true;
  });
  leftBtn.addEventListener("touchend", e => {
    e.preventDefault();
    leftPressed = false;
  });
  rightBtn.addEventListener("touchstart", e => {
    e.preventDefault();
    rightPressed = true;
  });
  rightBtn.addEventListener("touchend", e => {
    e.preventDefault();
    rightPressed = false;
  });

  // Mouse support for desktop
  leftBtn.addEventListener("mousedown", () => (leftPressed = true));
  leftBtn.addEventListener("mouseup", () => (leftPressed = false));
  leftBtn.addEventListener("mouseleave", () => (leftPressed = false));
  rightBtn.addEventListener("mousedown", () => (rightPressed = true));
  rightBtn.addEventListener("mouseup", () => (rightPressed = false));
  rightBtn.addEventListener("mouseleave", () => (rightPressed = false));

  // Keyboard support
  document.addEventListener("keydown", e => {
    if (e.key === "ArrowRight") rightPressed = true;
    if (e.key === "ArrowLeft") leftPressed = true;
    if (e.key === "p") togglePause();
  });
  document.addEventListener("keyup", e => {
    if (e.key === "ArrowRight") rightPressed = false;
    if (e.key === "ArrowLeft") leftPressed = false;
  });

  function togglePause() {
    gamePaused = !gamePaused;
    pauseOverlay.style.display = gamePaused ? "flex" : "none";
    if (!gamePaused) {
      animate();
    } else {
      cancelAnimationFrame(animationFrameId);
    }
  }

  function update() {
    // Update paddle target based on input
    if (rightPressed) paddle.targetX += paddle.speed;
    if (leftPressed) paddle.targetX -= paddle.speed;

    // Clamp target
    paddle.targetX = Math.min(
      Math.max(paddle.targetX, 0),
      canvas.width - paddle.width
    );

    // Smoothly move paddle to target
    paddle.x = lerp(paddle.x, paddle.targetX, 0.2);

    // Move ball
    ball.x += ball.dx;
    ball.y += ball.dy;

    // Ball collision with walls
    if (ball.x + ball.radius > canvas.width || ball.x - ball.radius < 0) {
      ball.dx = -ball.dx;
    }
    if (ball.y - ball.radius < 0) {
      ball.dy = -ball.dy;
    } else if (ball.y + ball.radius > canvas.height) {
      // Ball hits bottom - reset ball and paddle, update high score
      if (score > highScore) {
        highScore = score;
        localStorage.setItem("paddleQuestHighScore", highScore);
      }
      initializeGameObjects();
    }

    // Ball collision with paddle
    if (
      ball.y + ball.radius > paddle.y &&
      ball.x > paddle.x &&
      ball.x < paddle.x + paddle.width
    ) {
      ball.dy = -ball.dy;
      ball.y = paddle.y - ball.radius; // prevent sticking

      // Increase score on paddle hit
      score++;
      updateScoreDisplay();
    }
  }

  function drawPaddle() {
    ctx.fillStyle = "#00ffcc";
    ctx.fillRect(paddle.x, paddle.y, paddle.width, paddle.height);
  }

  function drawBall() {
    ctx.beginPath();
    ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
    ctx.fillStyle = "#ff4444";
    ctx.fill();
    ctx.closePath();
  }

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawPaddle();
    drawBall();
  }

  function animate() {
    if (gamePaused) return;
    update();
    draw();
    animationFrameId = requestAnimationFrame(animate);
  }

  // Initialize objects for the first time
  initializeGameObjects();
</script>

</body>
</html>
