<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Paddle Quest</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Lilita+One&display=swap');
  body {
    margin: 0;
    background-color: yellow; /* Changed to yellow */
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  canvas {
    background-color: yellow; /* Changed to yellow */
    display: block;
    touch-action: none;
  }
  /* Common text style */
  .game-text {
    font-family: 'Lilita One', cursive;
    color: white;
    text-shadow: 0 2px 4px rgba(0,0,0,0.7);
    -webkit-text-stroke: 0;
  }
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<script>
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');

  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  // Game states
  let currentScreen = 'home'; // home, playing, leaderboard, missions, paused, gameover
  let score = 0;
  let highScore = localStorage.getItem('pqHighScore') || 0;

  // Paddle properties
  const paddleWidth = 120;
  const paddleHeight = 20;
  let paddleX = (canvas.width - paddleWidth) / 2;
  const paddleY = canvas.height - paddleHeight - 30;
  const paddleSpeed = 7;

  // Ball properties
  const ballRadius = 15;
  let ballX = canvas.width / 2;
  let ballY = ballRadius + 10;
  let ballSpeedX = 4;
  let ballSpeedY = 4;

  // Controls
  let leftPressed = false;
  let rightPressed = false;
  let gamePaused = false;
  let gameOver = false;

  // Buttons positions
  const leftButton = { x: 20, y: canvas.height - 100, w: 80, h: 80 };
  const rightButton = { x: canvas.width - 100, y: canvas.height - 100, w: 80, h: 80 };
  const pauseButton = { x: 20, y: 20, w: 50, h: 50 };
  const homeButton = { x: canvas.width - 70, y: 20, w: 50, h: 50 };
  const backButton = { x: 20, y: 20, w: 50, h: 50 }; // for missions/leaderboard back

  // Missions example
  const missions = [
    { text: 'Catch 10 balls', done: false },
    { text: 'Score 20 points', done: false },
    { text: 'Play 5 games', done: false },
    { text: 'Reach 50 high score', done: false },
    { text: 'Pause the game 3 times', done: false },
  ];

  // Load images
  const pauseImg = new Image();
  pauseImg.src = 'pause.png';
  const homeImg = new Image();
  homeImg.src = 'home.png';
  const leftImg = new Image();
  leftImg.src = 'left.png';
  const rightImg = new Image();
  rightImg.src = 'right.png';
  const backImg = new Image();
  backImg.src = 'left.png'; // using left arrow as back

  // Touch controls
  canvas.addEventListener('touchstart', (e) => {
    e.preventDefault();
    for (let touch of e.touches) {
      let tx = touch.clientX, ty = touch.clientY;
      if (currentScreen === 'playing' && !gamePaused) {
        if (tx > leftButton.x && tx < leftButton.x + leftButton.w && ty > leftButton.y && ty < leftButton.y + leftButton.h) leftPressed = true;
        if (tx > rightButton.x && tx < rightButton.x + rightButton.w && ty > rightButton.y && ty < rightButton.y + rightButton.h) rightPressed = true;
        if (tx > pauseButton.x && tx < pauseButton.x + pauseButton.w && ty > pauseButton.y && ty < pauseButton.y + pauseButton.h) togglePause();
        if (tx > homeButton.x && tx < homeButton.x + homeButton.w && ty > homeButton.y && ty < homeButton.y + homeButton.h) backToHome();
      } else if (currentScreen === 'home') {
        // Check buttons on home
        if (tx > canvas.width / 2 - 100 && tx < canvas.width / 2 + 100) {
          if (ty > canvas.height / 2 && ty < canvas.height / 2 + 50) startGame(); // Play button
          else if (ty > canvas.height / 2 + 70 && ty < canvas.height / 2 + 120) currentScreen = 'leaderboard';
          else if (ty > canvas.height / 2 + 140 && ty < canvas.height / 2 + 190) currentScreen = 'missions';
        }
      } else if ((currentScreen === 'leaderboard' || currentScreen === 'missions') && tx > backButton.x && tx < backButton.x + backButton.w && ty > backButton.y && ty < backButton.y + backButton.h) {
        currentScreen = 'home';
      } else if (currentScreen === 'paused' && tx > 0 && tx < canvas.width && ty > 0 && ty < canvas.height) {
        togglePause();
      } else if (currentScreen === 'gameover' && tx > 0 && tx < canvas.width && ty > 0 && ty < canvas.height) {
        startGame();
      }
    }
  });

  canvas.addEventListener('touchend', (e) => {
    e.preventDefault();
    leftPressed = false;
    rightPressed = false;
  });

  // Keyboard controls for testing on PC
  window.addEventListener('keydown', (e) => {
    if (currentScreen !== 'playing' || gamePaused) return;
    if (e.key === 'ArrowLeft') leftPressed = true;
    if (e.key === 'ArrowRight') rightPressed = true;
    if (e.key.toLowerCase() === 'p') togglePause();
    if (e.key.toLowerCase() === 'h') backToHome();
  });

  window.addEventListener('keyup', (e) => {
    if (e.key === 'ArrowLeft') leftPressed = false;
    if (e.key === 'ArrowRight') rightPressed = false;
  });

  function drawText(text, x, y, size = '30px', align = 'center') {
    ctx.font = `${size} 'Lilita One', cursive, Arial, sans-serif`;
    ctx.fillStyle = 'white';
    ctx.textAlign = align;
    ctx.shadowColor = 'rgba(0,0,0,0.7)';
    ctx.shadowBlur = 4;
    ctx.shadowOffsetX = 0;
    ctx.shadowOffsetY = 2;
    ctx.fillText(text, x, y);
  }

  function drawHome() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawText('Paddle Quest', canvas.width / 2, canvas.height / 3, '70px');
    drawText('Drag Paddle To Catch The Ball!', canvas.width / 2, canvas.height / 3 + 70, '25px');

    // Draw buttons
    drawButton(canvas.width / 2 - 100, canvas.height / 2, 200, 50, 'PLAY', 'yellow');
    drawButton(canvas.width / 2 - 100, canvas.height / 2 + 70, 200, 50, 'Leaderboard', 'gray');
    drawButton(canvas.width / 2 - 100, canvas.height / 2 + 140, 200, 50, 'MISSIONS', 'gray');
  }

  function drawButton(x, y, w, h, text, color) {
    ctx.fillStyle = color;
    ctx.fillRect(x, y, w, h);
    drawText(text, x + w / 2, y + h / 2 + 10, '30px');
  }

  function drawPlaying() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Draw paddle
    ctx.fillStyle = '#0ff';
    ctx.fillRect(paddleX, paddleY, paddleWidth, paddleHeight);

    // Draw ball (red)
    ctx.beginPath();
    ctx.arc(ballX, ballY, ballRadius, 0, Math.PI * 2);
    ctx.fillStyle = 'red';
    ctx.fill();
    ctx.closePath();

    // Draw score
    drawText(`Score: ${score}`, 100, 50, '30px', 'left');
    drawText(`High: ${highScore}`, canvas.width - 100, 50, '30px', 'right');

    // Draw control buttons
    ctx.drawImage(leftImg, leftButton.x, leftButton.y, leftButton.w, leftButton.h);
    ctx.drawImage(rightImg, rightButton.x, rightButton.y, rightButton.w, rightButton.h);

    ctx.drawImage(pauseImg, pauseButton.x, pauseButton.y, pauseButton.w, pauseButton.h);
    ctx.drawImage(homeImg, homeButton.x, homeButton.y, homeButton.w, homeButton.h);

    if (gamePaused) {
      ctx.fillStyle = 'rgba(0,0,0,0.7)';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      drawText('Game Paused', canvas.width / 2, canvas.height / 2 - 20, '50px');
      drawText('Tap Anywhere To Continue', canvas.width / 2, canvas.height / 2 + 40, '25px');
    }

    if (gameOver) {
      drawText('Game Over', canvas.width / 2, canvas.height / 2 - 50, '50px');
      drawText('Tap to Retry', canvas.width / 2, canvas.height / 2 + 20, '30px');
    }
  }

  function drawLeaderboard() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawText('COMING SOON!', canvas.width / 2, canvas.height / 2, '50px');

    // Back button
    ctx.drawImage(backImg, backButton.x, backButton.y, backButton.w, backButton.h);
  }

  function drawMissions() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawText('MISSIONS', canvas.width / 2, 80, '50px');

    for (let i = 0; i < missions.length; i++) {
      const mission = missions[i];
      drawText(`${i + 1}. ${mission.text}`, 60, 140 + i * 40, '25px', 'left');
    }

    // Back button
    ctx.drawImage(backImg, backButton.x, backButton.y, backButton.w, backButton.h);
  }

  function updatePlaying() {
    if (gamePaused || gameOver) return;

    if (leftPressed && paddleX > 0) paddleX -= paddleSpeed;
    if (rightPressed && paddleX < canvas.width - paddleWidth) paddleX += paddleSpeed;

    ballX += ballSpeedX;
    ballY += ballSpeedY;

    // Bounce off left and right
    if (ballX < ballRadius || ballX > canvas.width - ballRadius) ballSpeedX *= -1;
    // Bounce off top
    if (ballY < ballRadius) ballSpeedY *= -1;

    // Bounce off paddle
    if (ballY + ballRadius > paddleY &&
        ballX > paddleX &&
        ballX < paddleX + paddleWidth) {
      ballSpeedY *= -1;
      score++;
      if (score > highScore) {
        highScore = score;
        localStorage.setItem('pqHighScore', highScore);
      }
      // Increase speed slightly
      ballSpeedX *= 1.05;
      ballSpeedY *= 1.05;
    }

    // Missed paddle
    if (ballY > canvas.height) {
      gameOver = true;
    }
  }

  function startGame() {
    currentScreen = 'playing';
    gameOver = false;
    score = 0;
    paddleX = (canvas.width - paddleWidth) / 2;
    ballX = canvas.width / 2;
    ballY = ballRadius + 10;
    ballSpeedX = 4;
    ballSpeedY = 4;
    gamePaused = false;
  }

  function togglePause() {
    if (currentScreen === 'playing') {
      gamePaused = !gamePaused;
      if (gamePaused) currentScreen = 'paused';
      else currentScreen = 'playing';
    }
  }

  function backToHome() {
    currentScreen = 'home';
    gamePaused = false;
    gameOver = false;
  }

  function gameLoop() {
    switch (currentScreen) {
      case 'home': drawHome(); break;
      case 'playing':
      case 'paused':
        drawPlaying();
        updatePlaying();
        break;
      case 'leaderboard': drawLeaderboard(); break;
      case 'missions': drawMissions(); break;
      case 'gameover': break; // Not used separately
    }
    requestAnimationFrame(gameLoop);
  }

  gameLoop();
</script>
</body>
</html>
